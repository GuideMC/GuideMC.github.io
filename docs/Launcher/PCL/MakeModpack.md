# 如何使用 PCL 制作整合包

## 我可以使用 PCL 制作整合包吗

PCL 正式版没有分发限制，因此可以发给其他人或是用于制作整合包、服务器客户端。

## 自动安装整合包

将你的整合包重命名为 modpack.zip 或 modpack.mrpack，和 PCL 的 exe 文件放在同一文件夹下。如果这样做，打开 PCL 时，PCL 会自动安装这一整合包。

## 删除自己的账号信息

PCL 将你的账号、密码等重要信息加密存储在注册表中，而不是文件中。因此，你无需刻意删除你的账号信息，它们不会随着你的整合包被发放给其他人。

## 自定义主页

你可以在 设置→个性化→主页 中自定义启动器的主页。你也可以将你的主页 XAML 文件上传到服务器，并通过 “联网更新” 选项实现主页的动态更新。

## 关闭启动器更新与公告

你可以在 设置→启动器→系统 中修改启动器的更新方式与公告推送方式。
如果你能通过 QQ 群等方式通知到所有使用你的整合包的玩家，你可以完全关闭启动器更新。如果你无法通知到使用整合包的所有玩家，则请至少选择 “仅在有重大漏洞更新时显示提示”，以免有玩家因为无法收到重大漏洞更新而无法正常游戏。
启动器公告包含紧急漏洞通知、PCL 的活动通知、新功能投票等推送弹窗。如果你需要屏蔽 PCL 的活动通知，你可以降低公告推送等级。如果没有必要，则推荐设置为 “显示所有公告”。

## 修改启动时 “你知道吗?” 的内容

在 PCL 文件夹下新建一个名为 hints.txt 的文件，然后每一行写入一条信息，即可修改启动时 “你知道吗?” 的内容。PCL 读取该文件时会忽略空行。若写入后出现乱码，可以尝试将编码改为 UTF-8。

## 自带 Java

如果你想让整合包自带某个版本的 Java，可以直接将 Java 放在版本文件夹（versions/版本名）中，PCL 会自动搜索并优先选用放在版本文件夹里的 Java。

## 关闭不需要的功能

你可以在 设置→个性化→功能隐藏 中关闭你不需要的功能入口，例如下载、个性化设置等页面。

## 备份配置文件

PCL 会在 PCL 文件夹中存储部分个性化设置（例如音乐、背景图片、启动器样式、自定义主页等），不包含个人信息。  
如果你正在制作整合包，且需要保留所设置的启动器个性化内容，你就需要在整合包中包含该文件夹。
打开 PCL 主程序所在文件夹，将该文件夹下的 PCL 文件夹复制到合适位置即可。

## 修改帮助文件

PCL 允许你自由修改帮助页面：你可以添加自己的帮助条目，或是隐藏内置的帮助条目。
如果你是服主或整合包作者，你可以将教程或是必要信息列入帮助中，为玩家提供便利。
此后，你还可以通过自定义主页功能，在主页添加一个打开特定帮助页面的按钮！
此外，你还可以添加让帮助条目之间互通的链接，也可以让它从主页或搜索结果中隐藏。
你甚至可以利用这些特性，在帮助页面中做一个文字游戏……

## 添加自定义帮助条目

## 1. 创建帮助文件夹

PCL 会从 PCL\Help 文件夹中读取自定义帮助条目，你需要在 PCL 文件夹中创建名为 Help 的文件夹，并把所有相关文件存放在其中。

## 2. 编辑 JSON 文件

每个帮助条目都是一个 JSON 文件。在加载帮助页面时，PCL 会查找帮助文件夹及其子文件夹中的所有扩展名为 .json 的文件，并作为帮助条目加载。
此外，查找时会忽略名称以英文句号开头的文件夹，例如 .git。
换而言之，你需要新建一个 JSON 文件来创建帮助条目。该文件的格式详见以下页面：

## 3. 编辑 XAML 文件

如果你的帮助条目不会触发事件（即第一类，IsEvent=False），你就需要创建一个与该 JSON 文件同名的 XAML 文件。
在你点击这个帮助条目的时候，PCL 会从该 XAML 文件中加载页面的实际内容。
XAML 文件的格式与自定义主页一致，你可以查看下述条目来了解详情：

## 4. 刷新帮助页面

在编辑完 JSON 与 XAML 文件后，你可以点击左边栏 帮助 项右侧的刷新按钮来快速重载所有帮助页面。
如果顺利的话，你就能找到你的帮助条目啦！

## 隐藏内置帮助条目

与读取自定义帮助条目时类似，PCL 会在帮助文件夹查找扩展名为 .helpignore 的文件，该文件可以用于隐藏 PCL 内置的帮助条目。
该文件的每行都是一条正则表达式，PCL 会对这些正则逐条进行匹配，如果某内置条目的相对路径符合该正则，那么该条目就会被忽略。
例如，这个帮助条目的路径为 帮助\自定义帮助.xaml，因此任何符合这一字符串的正则都可以隐藏这个条目。
此外，仅往文件中写入 \S* 就可以隐藏 PCL 的所有内置帮助，因为任何文件名都满足这条正则。

- [正则表达式教程](https://www.runoob.com/regexp/regexp-intro.html)

在读取 .helpignore 文件的内容时，空行、行首行尾空格以及每行的 # 符号之后的内容均会被忽略。
因此，你可以在 # 符号后书写注释。

- [打开 PCL 常见问题文档](https://shimo.im/docs/qKPttVvXKqPD8YDC)

## 概述

帮助条目分为两类，第一类在点击后会在 PCL 中打开一个新的帮助子页面，第二类则会触发事件（通常用于打开网页或执行程序），下列两项分别为第一类和第二类帮助条目的示例。

- 打开帮助: 帮助/自定义帮助.json
- 打开帮助: 百科/Minecraft Wiki.json

每个帮助条目都由对应的 JSON 文件生成，且第一类与第二类的格式要求略有不同。

## JSON 格式详述

| 字段名           | 必须 | 类型        | 描述                                                                 |
|------------------|------|-------------|----------------------------------------------------------------------|
| Title            | 必须 | String      | 帮助条目的标题，以及第一类中点击进入后的子页面左上角的标题。对 PCL 内置帮助库，它应该为对问题非常简短的概括。 |
| Description      | 可选 | String      | 帮助条目标题下方的描述。对 PCL 内置帮助库，它应该为对问题的进一步的详细描述。 |
| Logo             | 可选 | String      | 帮助条目的图标，第一类默认为草方块（弹出窗口为草径），第二类默认为命令方块。支持填写图片网址或本地文件地址。对 PCL 内置帮助库，应当不包含此项，全部使用默认图标。 |
| ShowInSearch     | 可选 | Boolean     | 控制该条目能否被搜索到。默认为 true。 |
| Keywords         | 可选 | String      | 额外的搜索关键字。在搜索帮助时，输入它们也能够搜索到该条目。对 PCL 内置帮助库，它应只包含未出现在 Title 与 Description 中的关键字。 |
| Types            | 可选 | List[String] | 一个字符串列表，控制该项会出现在帮助页面的首页的哪些卡片中。指南卡片会默认展开。若不写，该项则不会出现在帮助页面的首页。将这项留空，同时将 ShowInSearch 设为 false，即可完全隐藏该条目。 |
| ShowInPublic     | 可选 | Boolean     | 默认为 true。若改为 false，该条目会 PCL 正式版中隐藏。对 PCL 内置帮助库，如果内容涉及内群（例如群服务器、隐藏主题等），则应设置为 false。 |
| ShowInSnapshot   | 可选 | Boolean     | 默认为 true。若改为 false，该条目会 PCL 快照版中隐藏。 |
| IsEvent          | 可选 | Boolean     | 若为 true，在点击后会执行特定事件，而不打开页面，即第二类。若为 false (默认)，在点击后会打开同名的 XAML 页面，即第一类。 |
| EventType        | 第一类不填，第二类必须 | String | 点击该条目时执行的事件类别。详见自定义主页。 |
| EventData        | 第一类不填，第二类可选 | String | 点击该条目时执行的事件的额外参数。详见自定义主页。 |

## 第一类 JSON 范例

```json
{
    "__Author__": "龙腾猫跃",
    "Title": "自定义帮助页面",
    "Description": "添加自己的帮助页面，或是隐藏 PCL 内置的帮助页面",
    "Keywords": "个性化修改xaml",
    "Types": ["个性化"]
}
```

## 第二类 JSON 范例

```json
{
    "__Author__": "NotKiller233、龙腾猫跃",
    "Title": "Minecraft Wiki",
    "Description": "包含原版游戏过程中所需大多数知识的中文百科",
    "Keywords": "我的世界wikipedia",
    "Types": ["百科"],
    "IsEvent": true,
    "EventType": "打开网页",
    "EventData": "https://zh.minecraft.wiki/"
}
```

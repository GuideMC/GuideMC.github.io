# 崩溃问题参考指南

本章旨在成为一份全面的 Minecraft 崩溃问题参考手册。无论您是新手还是老手，都可以在这里找到识别问题、定位原因并实施解决方案的系统方法。

## 多人游戏连接

这类问题通常不会生成崩溃报告，而是在游戏内显示错误信息。

| 错误信息 | 原因分析 & 解决方案 |
| :--- | :--- |
| **Unknown host** / **Can't resolve hostname** | 无法找到服务器。**解决方案**：检查服务器地址是否拼写正确（建议复制粘贴）。 |
| **Connection timed out** | 连接超时。**解决方案**：1. 检查你的网络连接。 2. 确认服务器正在运行。 3. 尝试使用网络加速器。 4. 暂时关闭防火墙测试。 |
| **Connection refused: no further information** | 服务器拒绝了你的连接。**解决方案**：1. 确认服务器 IP 和端口正确。 2. 确认服务器已开启且防火墙允许该端口。 3. 联系服务器管理员。 |
| **Outdated server** / **Outdated client** | 客户端与服务器版本不匹配。**解决方案**：将你的游戏版本切换到与服务器完全一致的版本。 |
| **Failed to login: Invalid session** / **Bad login** | 正版验证失败。**解决方案**：1. 重启你的启动器和游戏。 2. 如果是离线模式玩家，无法进入正版验证服务器。 |
| **Fatally missing registry entries** | **(Mod服常见)** 客户端与服务端的 Mod 列表或版本不一致。**解决方案**：联系服主，获取与服务器**完全一致**的 Mod 文件和版本。一个都不能多，一个都不能少，版本号必须相同。 |
| **Internal Exception: io.netty.handler.codec.DecoderException** | 数据包解码失败。通常是客户端和服务端的某个 Mod 版本不匹配或存在 Bug。**解决方案**：同上，确保 Mod 完全一致。如果一致还报错，则可能是某个 Mod 的 Bug，需要逐个排查。 |

## 常见崩溃与解决方案

### 1. 依赖缺失或版本错误 (Dependency Issue)

**异常类型**：`java.lang.NoClassDefFoundError`, `java.lang.ClassNotFoundException`, `java.lang.NoSuchMethodError`
**常见场景**：游戏启动时立即崩溃。
**分析**：错误信息明确告诉你“找不到某个类或方法”。这几乎总是因为你安装了一个 Mod，却没有安装它所依赖的**前置 Mod**，或者前置/主 Mod 的版本不正确。

**Forge/NeoForge 环境**：日志中常会出现 `Missing or unsupported mandatory dependencies` 的提示，直接点出缺失的 Mod ID。
**Fabric 环境**：错误提示通常更直白，会显示 `Incompatible mod set!` 并列出具体问题。
**隐性依赖**：有时，一个 Mod 依赖另一个 Mod，但作者并未在元信息中声明。此时错误通常是更底层的 `ClassNotFoundException`。

**解决方案**：

1. **阅读 Mod 页面**：仔细阅读你下载的 Mod 的介绍页面（CurseForge/Modrinth），找到“Dependencies”或“Relations”标签，下载并安装所有**必需 (Required)** 的前置 Mod。
2. **检查版本兼容性**：确保主 Mod、所有前置 Mod、Mod 加载器（Forge/Fabric）以及游戏版本完全互相兼容。
3. **检查日志**：由于 `minecraft.log` 只记录最后一部分内容，依赖问题的核心证据可能已被刷掉。请检查游戏目录下的 `logs/latest.log` 文件，以获取完整的启动日志。

### 2. Mod 自身 Bug

**异常类型**：`java.lang.NullPointerException` (NPE, 空指针), `java.lang.ClassCastException` (类型转换异常), `java.lang.IllegalArgumentException` (非法参数), `java.util.ConcurrentModificationException` (并发修改异常)
**常见场景**：在游戏中执行特定操作时崩溃，如打开 GUI、使用物品、靠近特定方块、世界生成等。
**分析**：
`NullPointerException` (NPE)：最常见的 Bug。意味着 Mod 代码试图使用一个不存在（为空）的对象。**崩溃报告堆栈追踪 (Stack Trace) 顶部的 Mod 包名是头号嫌疑人**。
`ConcurrentModificationException`：常见于加载阶段，说明 Mod 作者没有正确处理多线程加载，导致了线程不安全。通常重启游戏可以解决，但本质上是 Mod 的 Bug。
**Mixin 注入 Bug**：如果崩溃发生在一个原版类中（如 `net.minecraft.xxx`），但你看到了形如 `handler$zcc000$someMethod` 的函数名，这说明是某个 Mod 通过 Mixin 注入的代码出了问题。

**解决方案**：

1. **更新 Mod**：检查崩溃报告中提到的 Mod 是否有新版本，更新通常能解决已知 Bug。
2. **报告 Bug**：如果已经是最新版，携带完整的崩溃报告（**不要截图，要上传 `crash-reports` 文件夹里的 `.txt` 文件**）去 Mod 的 GitHub Issues 页面向作者反馈。
3. **调整配置**：在 `config` 文件夹中找到嫌疑 Mod 的配置文件，尝试禁用可能导致问题的功能。
4. **禁用**：作为最终手段，禁用或移除导致问题的 Mod。

### 3. Ticking Entity / Block Entity (卡实体/方块)

**这是 `NullPointerException` 的一种特例，但极为常见，通常会导致服务器卡死或客户端崩溃。**
**常见描述**：`Ticking Entity`, `Ticking Block Entity`, `A single server tick took...`
**分析**：报告中会明确指出出错的实体/方块的ID和**坐标**。这通常是由于存档中某个数据损坏，或 Mod Bug 导致。
**解决方案**：
**方案一 (推荐)**：安装 **[Neruina (Forge)](https://www.mcmod.cn/class/10051.html)** 或 **[ManyIdeas (Fabric)](https://www.mcmod.cn/class/10543.html)**。它们能捕获此类错误，防止游戏崩溃，并报告问题来源。
**方案二 (Forge)**：在配置文件中启用错误实体移除功能。
    **低版本 (1.12.2)**：打开 `config/forge.cfg`，将 `removeErroringTileEntities` 和 `removeErroringEntities` 设置为 `true`。
    **高版本 (1.16+)**：打开 `saves/存档名/serverconfig/forge-server.toml`，将 `removeErroringEntities` 和 `removeErroringEntities` 设置为 `true`。
        > **警告**：进入游戏后请立即将此选项改回 `false`，以免误删正常实体。
**方案三**：使用外部工具手动编辑存档。
    1. **务必备份存档！**
    2. 根据崩溃报告中的坐标，使用 **[NBTExplorer](https://github.com/jaquadro/NBTExplorer/releases)** 或世界编辑器 (如 **[Amulet](https://www.amuletmc.com/)**) 定位并删除出错的实体或方块。
**方案四 (服务器端)**：如果你是服主，服务器因为 `A single server tick took...` 而崩溃，可以编辑 `server.properties` 文件，将 `max-tick-time` 的值设为 `-1`。这会禁用服务器的“看门狗”超时检查，防止因瞬间卡顿而关服，但治标不治本。

### 4. Mixin 冲突 (硬冲突)

**异常类型**：`org.spongepowered.asm.mixin.transformer.throwables.MixinTransformerError`
**常见场景**：启动时崩溃，常见于 Fabric 环境或使用了 Mixin 技术的 Forge Mod。
**分析**：这是“硬冲突”，意味着两个或多个 Mod 试图以不兼容的方式修改游戏代码的同一个地方（例如，一个 Mod `Overwrite` 了一个方法，导致另一个 Mod 的 `Inject` 找不到注入点）。报告会明确指出哪个 Mod 的哪个 Mixin 文件应用失败。
**解决方案**：

1. **没有简单的用户解决方案**，因为这是代码层面的冲突。
2. **更新或报告**：检查相关 Mod 是否有更新。如果没有，向作者报告此不兼容问题。
3. **移除**：只能通过“二分法”排查并移除冲突的 Mod 之一。
4. **高级诊断 (Fabric)**：如果在日志中无法确定冲突的另一方，可在 JVM 参数中添加 `-Dmixin.dumpTargetOnFailure=true`。崩溃后，游戏目录会生成一个 `.mixin.out` 文件夹，包含转换失败的类文件，通过反编译这些文件可以帮助定位冲突源。

### 5. 文件与数据问题

#### 配置文件错误

**异常类型**：`com.electronwill.nightconfig.core.io.ParsingException` (Forge 配置), `com.google.gson.JsonSyntaxException` (JSON 解析)
**常见场景**：启动时或加载世界时崩溃。
**分析**：
`ParsingException`：你手动修改了 Mod 的 `.toml` 配置文件并引入了语法错误。
`JsonSyntaxException`：某个数据包（如自定义配方）的 JSON 文件格式错误。
**解决方案**：
**对于配置文件错误**：删除 `config` 文件夹下报告中提到的那个 `.toml` 文件，重启游戏让它重新生成。
**对于数据包错误**：报告会指出出错的文件路径。找到它并修正其 JSON 语法，或直接移除该数据包/Mod。

#### 模组文件损坏

**异常类型**：`java.util.zip.ZipException: zip END header not found`
**常见场景**：启动时崩溃。
**分析**：这表示至少有一个 Mod 的 `.jar` 文件在下载或传输过程中损坏了，它不是一个有效的压缩文件。
**解决方案**：

1. **定位损坏文件**：Fabric Loader 通常会直接在日志中指出损坏的文件名。对于 Forge，你需要手动排查。
2. **手动排查**：用压缩软件（如 7-Zip）逐个测试 `mods` 文件夹里的 `.jar` 文件，无法打开的就是损坏的。
3. **重新下载**：删除损坏的 Mod 文件，并从官方渠道（CurseForge/Modrinth）重新下载。

### 6. Java 与启动器问题

**异常类型**：`Unsupported class file major version`, `java.lang.IllegalAccessError`, `JVM a fatal error has been detected...` (生成 `hs_err_pid` 文件)
**常见场景**：点击“启动游戏”后，窗口一闪而过或长时间无反应，或日志中出现明显的 Java 版本错误。
**分析**：问题出在 Java 运行环境本身或启动器的高级设置上，而非游戏内容。
**解决方案**：

1. **使用正确的 Java 版本**：
    **1.16.5 及以下**：推荐 Java 8。
    **1.17.x**：需要 Java 16 或 17。
    **1.18.x 及以上**：需要 Java 17 或更高版本。
    **错误特征**：
        `Unsupported class file major version`：用低版本 Java 启动了高版本游戏。
        `ClassMetadataNotFoundException: java.util.Objects`：用高版本 Java（如 Java 11+）启动了非常低版本的游戏（如 1.12.2），但又缺少必要的兼容修复。
2. **使用 64 位 Java**：在 64 位操作系统上，务必安装 64 位 Java，否则内存分配会限制在 1.5G 左右。
3. **调整 JVM 高级参数**：
    **C2 编译器问题**：如果 `hs_err_pid.log` 显示崩溃线程为 `C2 CompilerThread`，可在 JVM 参数中添加 `-XX:TieredStopAtLevel=3` 禁用它。
    **清除不明参数**：移除任何从网上复制的、你不理解其作用的“优化”参数。
4. **启动器设置**：
    **版本隔离**：务必开启启动器的“版本隔离”功能。
    **不要混用启动器**：**不要**使用 A 启动器（如 HMCL）去管理或修改由 B 启动器（如 PCL）安装的游戏实例。

### 7. 系统与环境配置问题

**异常类型**：`java.io.FileNotFoundException` (路径中的中文变成 `????`), `java.nio.charset.MalformedInputException`
**常见场景**：游戏启动时崩溃，且错误与文件路径或配置文件解析有关。
**分析**：这类问题并非 Mod 的 Bug，而是你的 Windows 系统环境与 Java 程序不兼容。
**解决方案**：

1. **使用纯英文路径**：将整个游戏（包括启动器和 `.minecraft` 文件夹）移动到一个**纯英文路径**下（例如 `D:\Games\Minecraft`）。
2. **关闭 Windows UTF-8 Beta 功能**：前往 “控制面板” > “区域” > “管理”，点击“更改系统区域设置”，**取消勾选“Beta 版: 使用 Unicode UTF-8 提供全球语言支持”**，然后重启电脑。
3. **使用合法用户名**：使用仅包含英文字母、数字、下划线的用户名。
4. **检查文件夹权限**：避免将游戏安装在“桌面”、“下载”等受系统严格保护的目录。

### 8. 图形/渲染崩溃 (Graphics Crash)

**异常类型**：`EXCEPTION_ACCESS_VIOLATION` (通常伴随 `...dll` 文件名，如 `ig4icd64.dll` (Intel), `nvoglv64.dll` (NVIDIA), `atio6axx.dll` (AMD))，或游戏内频繁的 `OpenGL Error: 128x` 错误。
**常见场景**：启动游戏时、加载光影、进入世界时闪退，或游戏画面异常（花屏、透明）。
**分析**：问题的根源是**显卡驱动**与 Minecraft 使用的 **OpenGL** 图形接口不兼容。
**解决方案**：

1. **更新显卡驱动**：前往 NVIDIA, AMD 或 Intel 官网，下载并安装适用于你显卡型号的最新驱动。**这是解决渲染问题的首要且最有效的步骤。**
2. **切换独立显卡**：在 NVIDIA 控制面板或系统图形设置中，将 `javaw.exe` 程序设置为使用“高性能”独立显卡运行。
3. **软渲染测试**：在启动器的高级设置中，尝试开启“使用 OpenGL 软渲染器”。如果游戏能启动，则**100%确定是显卡驱动问题**。软渲染性能极低，仅用于测试。
4. **处理特定冲突**：关闭与 OptiFine/Oculus/Iris 等渲染 Mod 可能冲突的功能，如其他 Mod 的发光效果。

### 9. 硬件与系统底层故障

**异常类型**：随机、无规律的崩溃，`EXCEPTION_ACCESS_VIOLATION`，蓝屏 (BSOD)，或游戏冻结。
**常见场景**：崩溃没有任何固定规律，有时能玩很久，有时启动就崩，且崩溃报告可能每次都不同。`hs_err_pid.log` 文件可能指向 `ntdll.dll` 等系统核心文件。
**分析**：这是最难排查的一类问题，因为它可能与你的物理硬件或操作系统底层有关。
**解决方案 (诊断为主)**：

1. **检查内存条**：不稳定的内存是随机崩溃的常见元凶。关闭所有超频（特别是内存 XMP），然后使用 MemTest86 等工具进行全面的内存压力测试。
2. **检查虚拟内存**：确保 Windows 的虚拟内存（页面文件）设置为“系统管理的大小”，或分配在有足够空间的、健康的硬盘上。虚拟内存不足也会导致 `Out of Memory` 类型的 JVM 崩溃。
3. **检查系统日志**：在 Windows 的“事件查看器”中，查找与游戏崩溃时间点对应的“错误”记录。
4. **检查硬盘健康**：使用 CrystalDiskInfo 等工具检查硬盘的 S.M.A.R.T. 状态。

### 10. 游戏无响应或卡死 (Freeze/Hang)

**常见场景**：游戏画面卡住不动，声音停止，但没有生成崩溃报告。Windows 可能会提示“程序未响应”。
**分析**：这通常是由于主线程被长时间阻塞（死锁或长耗时操作）导致的。
**解决方案**：

1. **获取线程转储 (Thread Dump)**：在游戏卡死时，使用启动器（如 HMCL）的“导出运行栈”功能，或使用 `jstack` 命令，获取一份线程快照。
2. **分析转储文件**：在文件中查找 `Client thread` 或 `Server thread`，查看其状态。
    如果它处于 `BLOCKED` 状态，说明它在等待另一个线程释放锁，可能发生了死锁。
    如果它正在执行某个 Mod 的代码（如文件读写、网络请求），说明该 Mod 的操作耗时过长导致了卡死。
3. **常见原因**：
    Mod 在主线程进行网络请求（如检查更新、下载资源）。
    Mod 在主线程读取或写入大型文件（如 Xaero's World Map）。
    游戏在处理大量实体或复杂的结构生成。
4. **临时解决**：耐心等待，或根据分析结果，升级/禁用相关 Mod，或在服务器上调整 `max-tick-time`。

### 11. 模组重复 (Duplicate Mod)

**常见场景**：启动时崩溃，日志中明确提示 `Found duplicate mods` 或 `Duplicate brand`。
**分析**：你在 `mods` 文件夹里放了同一个 Mod 的多个版本，或者放了功能高度重叠、互相冲突的 Mod（如同时安装了 OptiFine 和 Sodium）。
**解决方案**：

1. **清理 mods 文件夹**：仔细检查并删除重复的 `.jar` 文件。
2. **选择其一**：对于功能冲突的 Mod（如 Jade vs WTHIT, Embeddium vs Rubidium），只保留一个。
